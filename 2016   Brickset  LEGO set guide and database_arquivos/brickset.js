$(function(){setupAjax();setupHomePageForms();setupViewMoreLinks();setupHomePageShopping();setupAutocomplete();setupAddToMenu();setupCountrySelect();setupAddTagForm()
setupHighslide();setupOwnershipControls();setupReviewRatings();setupBricklistRatings();setupVideoReviews();setupReviewAdmin();setupBrickListAdmin();setupQueryAdmin();setupSetNumberInput();setupUserInput();setupMinifigNameInput();setupArticlePage();setupTabs();setupBuyPage();setupContactPage();setupLikeButtons();setupFAQPage();setupSetRatings();setupPoll();setupResultsPage("aside.parts","parts")
setupResultsPage("aside.minifigs","minifigs")
setupResultsPage("aside.sets","sets")
setupResultsPage("aside.news","news")
setupResultsPage("aside.instructions","instructions")
setupResultsPage("aside.inventories","inventories")
setupResultsPage("aside.reviews","reviews")
setupResultsPage("aside.bricklists","bricklists")
setupResultsPage("aside.queries","queries")
setupResultsPage("aside.buy","buy")
setupResultsPage("aside.rent","rent")
setupResultsPage("aside.colours","colours")
setupVariousThings()});function setupVariousThings(){jQuery.fn.highlight=function(){$(this).each(function(){var el=$(this);el.before("<div/>")
el.prev().width(el.width()).height(el.height()).css({"position":"absolute","background-color":"#ffff99","opacity":".9"}).fadeOut(500);});}
if(typeof articleID!='undefined'){$("#viewCount").load('/ajax/news/updateViewCount?articleID='+articleID)}
if(typeof brickLinkSet!='undefined'){$("#brickLinkOutput").load('/ajax/bricklink?t=set&q='+brickLinkSet+"&cc="+brickLinkCC)}
if(typeof brickLinkMinifig!='undefined'){$("#brickLinkOutput").load('/ajax/bricklink?t=minifig&q='+brickLinkMinifig+"&cc="+brickLinkCC)}
if(typeof brickLinkPart!='undefined'){$("#brickLinkOutput").load('/ajax/bricklink?t=part&q='+brickLinkPart+"&cc="+brickLinkCC)}
if(typeof doEbaySearch!='undefined'){ebaySearch()}
if(typeof rebrickableSet!='undefined'){$("#rebrickableOutput").load('/ajax/sets/rebrickable?set='+rebrickableSet);}
if(typeof alternateBuildCountSetNumber!='undefined'){$("#alternateBuildCount").load('/ajax/sets/altBuildCount?set='+alternateBuildCountSetNumber);}
if(typeof swooshableSetNumber!='undefined'){var currentCount=$("#swooshableCount").text();$("#swooshableCount").load('/ajax/sets/swooshableCount?c='+currentCount+'&set='+swooshableSetNumber);}
if(typeof drawCollectionGraph_theme=='function'){drawCollectionGraph_theme();}
if(typeof drawCollectionGraph_subtheme=='function'){drawCollectionGraph_subtheme();}
if(typeof drawCollectionGraph_year=='function'){drawCollectionGraph_year();}
if(typeof drawCollectionGraph=='function'){drawCollectionGraph();}
if(typeof drawCollectionGraph_category=='function'){drawCollectionGraph_category();}
if(typeof disableCollectionControls!='undefined'){$('.ownCheckbox').attr('disabled','disabled');$('.wantCheckbox').attr('disabled','disabled');$('.flagCheckbox').attr('disabled','disabled');$('.qtyOwned').attr('disabled','disabled');$('.acmlink').hide();}
extLinks('.content');$("img.thumbnail").lazyload();$('div.featurebox ul.tools').nmcDropDown({});$("table.tablesorter").tablesorter();$('.form select').selectBoxIt();$('div.browselinks select').selectBoxIt();$("[data-slider]").each(function(){$("<span>").addClass("output").insertAfter($(this));}).bind("slider:ready slider:changed",function(event,data){$(this).nextAll(".output:first").html(data.value.toFixed(0));});$('div.browselinks select').change(function(e){if($(this).val())
location.replace($(this).val())});var box=document.getElementById("fileuploadbox");if(box!=null){box.addEventListener("dragenter",OnDragEnter,false);box.addEventListener("dragover",OnDragOver,false);box.addEventListener("drop",OnDrop,false);function OnDragEnter(e){e.stopPropagation();e.preventDefault();}
function OnDragOver(e){e.stopPropagation();e.preventDefault();}
function OnDrop(e){e.stopPropagation();e.preventDefault();selectedFiles=e.dataTransfer.files;var data=new FormData();for(var i=0;i<selectedFiles.length;i++){data.append(selectedFiles[i].name,selectedFiles[i]);}
$.ajax({type:"POST",url:"/webhandlers/fileUpload.ashx?m="+$("#fileuploadmessage").length,contentType:false,processData:false,data:data,success:function(result){if($("#fileuploadmessage").length){$("#fileuploadmessage").html(result)}else{var data=result.split(';',2);var thumb=data[0];var original=data[1];$('#ctl00_mainContent_Repeater1_ctl00_ogImageURL').val(original)
$('#ctl00_mainContent_Repeater1_ctl00_mainImageURL').val(thumb)
$('#ctl00_mainContent_Repeater1_ctl00_mainImageNavigateURL').val(original)}},error:function(){$("#fileuploadmessage").text("Error uploading files. Please try again.");}});}}
box=document.getElementById("imageuploadbox");if(box!=null){box.addEventListener("dragenter",OnDragEnter,false);box.addEventListener("dragover",OnDragOver,false);box.addEventListener("drop",OnDrop,false);function OnDragEnter(e){e.stopPropagation();e.preventDefault();}
function OnDragOver(e){e.stopPropagation();e.preventDefault();}
function OnDrop(e){e.stopPropagation();e.preventDefault();selectedFiles=e.dataTransfer.files;var data=new FormData();for(var i=0;i<selectedFiles.length;i++){data.append(selectedFiles[i].name,selectedFiles[i]);}
$.ajax({type:"POST",url:"/webhandlers/setImageUpload.ashx?s="+setNumber+"&t="+imageType,contentType:false,processData:false,data:data,success:function(result){if(result!=''){$('#fileuploadmessage').html(result)
$('#imageOKButton').show();}else
$("#fileuploadmessage").text("Error uploading file. Please try again.");},error:function(){$("#fileuploadmessage").text("Error uploading file. Please try again.");}});}}
if(typeof loggedIn!='undefined'){if(loggedIn==1){$(window).scroll(function(){if($(this).scrollTop()!=0){$('#toTop').fadeIn();}else{$('#toTop').fadeOut();}});$('#toTop').click(function(){$('body,html').animate({scrollTop:0},800);});}}
$(".tagsfilter .remove").show();var match=window.location.href.split('?')[1];$('#tagTheme').find('option[value$="'+match+'"]').attr('selected',true);$('#tagTheme').change(function(e){var locAppend=$(this).find('option:selected').val(),locSnip=window.location.href.split('?')[0];window.location.href=locSnip+locAppend;});$('#showNotes').click(function(){$('#notes').slideToggle();});$(".smlinks img").hover(function(){this.src=this.src.replace("_m","_c");},function(){this.src=this.src.replace("_c","_m");});$('input:radio[name=which]').change(function(){locSnip=window.location.href.split('?')[0];window.location.href=locSnip+"?query="+$(this).val()});if(setup==1){$.post('/ajax/master/setup',{},function(data){$("#userstats").html(data);});}}
function setupPoll(){$('.pollsubmit').click(function(e){e.stopPropagation();e.preventDefault();var id=right(this.id,this.id.length-1);var option=$('input[name=poll'+id+']:checked').val();if(option!=undefined){$.post('/webhandlers/savePollResponse.ashx',{'id':id,'option':option},function(data){$("#s"+id).hide();$("#option"+id).hide();$("#message"+id).html(data);$.cookie('poll'+id,1,{expires:30});setupPoll();});}});$('.pollresults').click(function(e){e.stopPropagation();e.preventDefault();var id=right(this.id,this.id.length-1);$.post('/webhandlers/getPollResponses.ashx',{'id':id},function(data){$("#message"+id).html(data);});});}
function setupFAQPage(){$('body.faq h2 a').click(function(e){e.stopPropagation();e.preventDefault();if(!$(this).parent().next().is(":visible")){$(this).parent().next().slideDown().css('background-color','#FFFFC0');$(this).parent().css('background-color','#FFFFC0')}else{$(this).parent().next().slideUp().css('background-color','white')
$(this).parent().css('background-color','white')}});}
function setupLikeButtons(){$('a.articlelikebutton').click(function(e){e.stopPropagation();e.preventDefault();var id=right(this.id,this.id.length-4);var data=id.split(';',2);var articleid=data[0];var userid=data[1];var src=$("#img"+articleid).attr('src');if(src.indexOf("normal")>0){src=src.replace("normal","highlight");$.post('/webHandlers/articleLike.ashx',{'userid':userid,'articleid':articleid,'like':1},function(data){$("#liketext"+articleid).html(data)});}else{src=src.replace("highlight","normal");$.post('/webHandlers/articleLike.ashx',{'userid':userid,'articleid':articleid,'like':0},function(data){$("#liketext"+articleid).html(data)});}
$("#img"+articleid).attr('src',src);});$('a.commentlikebutton').click(function(e){e.stopPropagation();e.preventDefault();var id=right(this.id,this.id.length-4);var data=id.split(';',2);var commentid=data[0];var userid=data[1];var src=$("#img"+commentid).attr('src');if(src.indexOf("normal")>0){src=src.replace("normal","highlight");$.post('/webHandlers/commentLike.ashx',{'userid':userid,'commentid':commentid,'like':1},function(data){$("#liketext"+commentid).html(data)});}else{src=src.replace("highlight","normal");$.post('/webHandlers/commentLike.ashx',{'userid':userid,'commentid':commentid,'like':0},function(data){$("#liketext"+commentid).html(data)});}
$("#img"+commentid).attr('src',src);});}
function setupContactPage(){$('body.contact dt a').click(function(e){e.stopPropagation();e.preventDefault();$('dd').slideUp();if(!$(this).parent().next().is(":visible"))
$(this).parent().next().slideDown();});$('a.showformTrue').click(function(e){e.stopPropagation();e.preventDefault();$('form .message').slideDown();$('form .submit').slideDown();$('#title').val($(this).text());});$('a.showformFalse').click(function(e){e.stopPropagation();e.preventDefault();$('form .message').slideUp();$('form .submit').slideUp();});}
function setupAjax(){$.ajaxSetup({cache:false});$('#ajaxContainer').dialog({autoOpen:false,modal:true,show:'fade',hide:'fade',position:{my:"top",at:"top+50",of:window},});}
function setupTabs(){var msg="<div class='tab-loading textcenter'><img src='/assets/images/misc/ajax-loader-large.gif' /></div>";var tabOpts1={cache:false,ajaxOptions:{cache:false},load:function(e,ui){$(ui.panel).find(".tab-loading").remove();},select:function(e,ui){var $panel=$(ui.panel);if($panel.is(":empty")){$panel.append(msg)}}};var tabOpts2={cache:false,ajaxOptions:{cache:false},load:function(e,ui){$(ui.panel).find(".tab-loading").remove();},select:function(e,ui){var $panel=$(ui.panel);if($panel.is(":empty")){$panel.append(msg)}},active:$.cookie($('body').attr('class')),activate:function(event,ui){$.cookie($('body').attr('class'),ui.newTab.index(),{expires:365});}};$(function(){$("body.listview .tabs, body.galleryview .tabs, body.tableview .tabs").tabs(tabOpts1).show();});$(function(){$("body.default .tabs").tabs(tabOpts2).show();});if(typeof activeTopTab!='undefined')
$(function(){$(".tabs.top ").tabs("option","active",activeTopTab)});if(typeof activeBottomTab!='undefined')
$(function(){$(".tabs.bottom ").tabs("option","active",activeBottomTab)});}
function setupAddToMenu(){$('a.addtomenu').click(function(e){e.stopPropagation();e.preventDefault();var userID=right(this.id,this.id.length-1)
var link=location.href
var title=document.title
$.post('/webhandlers/addtomenu.ashx',{'link':link,'title':title,'userID':userID},function(data){$("#userlinks").hide().html(data).fadeIn(500)});var origHTML=$(this).html();$(this).html($(this).html()+'<span> -- Added!</span>');$('a.addtomenu span').fadeOut(1000);$(this).html(origHTML);});}
function setupBuyPage(){$('#ebaySearch').click(function(e){e.preventDefault();ebaySearch();});$('a.hideamazontheme').click(function(e){e.preventDefault();if($(this).html()=='Hide'){$(this).parent().next().hide();$(this).html("Show");}else{$(this).parent().next().show();$(this).html("Hide");}
saveAmazonCookie2();});var themeList=$.cookie('amazonThemes')
var themes
if(themeList!=null){$(".amazonblock").hide();themes=themeList.split("|");$('#selectAll').prop('checked',false);for(var i in themes){if(themes[i]!=''){$('#cb_'+themes[i]).prop('checked',true);$('#div_'+themes[i]).slideDown()}};if(themes.length-1==$('.themeCheckbox').length)
$('#selectAll').prop('checked',true);}else{$(".amazonblock").show();$('.themeCheckbox').prop('checked',true);$('#selectAll').prop('checked',true);}
$('.themeCheckbox').click(function(e){saveAmazonCookie();if(this.checked)
$('#div_'+this.value).slideDown()
else
$('#div_'+this.value).slideUp();});$('#selectAll').click(function(e){$('.themeCheckbox').prop('checked',this.checked);saveAmazonCookie();if(this.checked)
$(".amazonblock").slideDown()
else
$(".amazonblock").slideUp();});$('#wantedOnly').click(function(e){if(this.checked)
$(".notwanted").slideUp()
else
$(".notwanted").slideDown();});}
function saveAmazonCookie2(){var cookie='';$.cookie('amazonThemes',cookie,{expires:365});$('a.hideamazontheme').each(function(){if($(this).html()=='Show'){cookie=cookie+this.id+'|';}});$.cookie('amazonThemes2',cookie,{expires:365});};function saveAmazonCookie(){var cookie='';$.cookie('amazonThemes2',cookie,{expires:365});$('.themeCheckbox').each(function(){if(this.checked)
cookie=cookie+this.value+'|';});$.cookie('amazonThemes',cookie,{expires:365});};function ebaySearch(){var loading='<center><img src="/assets/images/misc/ajax-loader-large.gif" /></center>'
var site=$('#ebaySite').val();var query=$('#ebayQuery').val();if(query!=''){$('#ebayListContainer').html(loading);$.get('/ajax/sets/ebay.aspx',{'site':site,'query':query},function(data){$('#ebayListContainer').html(data);});}}
function setupArticlePage(){$('#commentsform').submit(function(e){e.stopPropagation();e.preventDefault();var comment=$('#comment').val();var userid=$('#userid').val();var articleid=$('#articleid').val();$.post('/ajax/news/addComment',{'comment':comment,'userid':userid,'articleid':articleid},function(data){$('#comments').append(data);$('#comment').val('');setupCommentAdmin();});return false;});setupCommentAdmin();}
function setupCommentAdmin(){$('section.comments a.reportcomment').click(function(e){e.preventDefault();var id=right(this.id,this.id.length-1);$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/news/reportComment?commentID="+id).dialog("open");return false;});jQuery.fn.putCursorAtEnd=function(){return this.each(function(){var $el=$(this),el=this;if(!$el.is(":focus")){$el.focus();}
if(el.setSelectionRange){var len=$el.val().length*2;setTimeout(function(){el.setSelectionRange(len,len);},1);}else{$el.val($el.val());}
this.scrollTop=999999;});};var comment=$("#comment");comment.on("focus",function(){comment.putCursorAtEnd()});$('section.comments a.replycomment').click(function(e){e.preventDefault();e.stopPropagation();var id=right(this.id,this.id.length-1);$.post('/webHandlers/getComment.ashx',{'commentID':id},function(data){$("#comment").html(data);$("#comment").focus();$("#comment").scrollIntoView();});return false;});$('section.comments a.editcomment').click(function(e){$('section.comments a.editcomment').unbind('click');e.preventDefault();e.stopPropagation();var id=right(this.id,this.id.length-1)
var t=$("#comment"+id+" .comment p").html();t=t.replace(/<br>/g,"&#10;");$("#comment"+id+" .comment p").html("<textarea id='ta"+id+"'>"+t+"</textarea><input type='button' value='Save' class='commentSave' name='"+id+"'/>");$("#comment"+id+" .action").html("<a href='#' class='commentCancelEdit' id='c"+id+"' >Cancel</a>&nbsp;");$("#comment"+id+" .action").addClass("cancel");$("#comment"+id+" .links").hide();$('input.commentSave').click(function(){var commentID=this.name;var comments=$('#ta'+this.name).val();$.post('/webHandlers/updateComment.ashx',{'commentID':commentID,'comments':comments},function(data){$("#comment"+commentID).html(data);$("#comment"+commentID+" .links").hide();setupCommentAdmin();});return false;});$('a.commentCancelEdit').click(function(){e.preventDefault();e.stopPropagation();var commentID=right(this.id,this.id.length-1);$.post('/webHandlers/updateComment.ashx',{'commentID':commentID,'comments':''},function(data){$("#comment"+commentID).html(data);$("#comment"+commentID+" .links").hide();setupCommentAdmin();});return false;});return false;});$('section.comments a.delcomment').click(function(e){e.preventDefault();e.stopPropagation();if(window.confirm("Click OK confirm you want to delete this comment.")){var id=right(this.id,this.id.length-1)
$.post('/WebHandlers/delComment.ashx',{'commentID':id},function(data){$("#comment"+id).fadeOut();});}
return false;});}
function setupResultsPage(selector,cookiePrefix){$(selector+' div.addtags select').change(function(e){if($(this).val())
location.replace($(this).val())});$(selector+' div.tags select').change(function(e){if($(this).val())
location.replace($(this).val())});$(selector+' div.resultsfilter ul.pagelength li a').click(function(e){e.preventDefault();$.cookie(cookiePrefix+'PageLength',$(this).text(),{expires:365,path:'/'});var url=window.location.href;url=url.replace(/\/page-[0-9]*/,"");location.replace(url);});$(selector+' #sortby').change(function(e){$.cookie(cookiePrefix+'SortOrder',$(this).val(),{expires:365,path:'/'});var url=window.location.href;url=url.replace(/\/order-[a-zA-Z]*/,"");location.replace(url);});if(cookiePrefix=='sets'){$(selector+' div.resultsfilter ul.viewswitch li a').click(function(e){$.cookie(cookiePrefix+'ListFormat',$(this).text(),{expires:365,path:'/'});e.preventDefault();if($('body').attr('class')=='tableview')
location.replace(window.location.href);else if($('body').attr('class')=='csvview')
location.replace(window.location.href);else if($('body').attr('class')=='compareview')
location.replace(window.location.href);else{$('.resultsfilter .viewswitch li').removeClass('active');$(this).parent().addClass('active');if($(this).text().toLowerCase().indexOf("list")!=-1){$('body').removeClass('galleryview').addClass('listview');$('article.set, article.set > .mainimg, article.set .meta .tags').css('height','auto');}else if($(this).text().toLowerCase().indexOf("gallery")!=-1){$('body').removeClass('listview').addClass('galleryview');equalheight('article.set > .mainimg');equalheight('article.set .meta .tags');equalheight('article.set');}else{location.replace(window.location.href);}}});}else{$(selector+' div.resultsfilter ul.viewswitch li a').click(function(e){e.preventDefault();$.cookie(cookiePrefix+'ListFormat',$(this).text(),{expires:365,path:'/'});location.replace(window.location.href);});}}
var notLoggedIn='You must be logged in to be able to use this feature';function contactForm(ev){ev.stopPropagation();ev.preventDefault();$('#contactFormSubmit').hide();var name=$('#contactFormName').val(),email=$('#contactFormEmail').val(),message=$('#contactFormMessage').val();$.post('/WebHandlers/contactForm.ashx',{'name':name,'email':email,'message':message},function(data){showMessage("#contactFormResult",data);$('#contactFormMessage').val('');$('#contactFormSubmit').show();});return false;}
function signupForm(ev){ev.stopPropagation();ev.preventDefault();$('#signupSubmit').hide();var name=$('#signupUsername').val(),email=$('#signupEmail').val();$.post('/WebHandlers/signupForm.ashx',{'name':name,'email':email},function(data){showMessage("#signupFormResult",data);$('#signupSubmit').show();});return false;}
function extLinks(selector){$(selector+' a').each(function(){try{var a=new RegExp('brickset.*com|javascript|localhost|1000steine|/MN/|lego.com/service|addthis|catawiki|staticflickr');var b=new RegExp('/click/|twitter');if(this.href!=''){if(!a.test(this.href)||b.test(this.href)){var title=$(this).attr('title');if(title&&title.length>0)
title=title+'. '
else
title='';$(this).attr('title',title+'Link to external website, opens in a new tab.');$(this).attr('rel','nofollow')
$(this).click(function(event){event.preventDefault();event.stopPropagation();window.open(this.href,'_blank');});}}}
catch(err){}});}
function autocomplete(){$("#searchQuery").autocomplete({source:function(request,response){$.ajax({url:"/webhandlers/autocomplete.ashx",data:"d="+$('#searchScope').val()+"&q="+request.term.trim(),dataType:"json",type:"GET",contentType:"application/json; charset=utf-8",dataFilter:function(data){return data;},success:function(data){response(data.d.split(","));},error:function(){}});},minLength:3,focus:function(event,ui){search_option=ui.item;},select:function(event,ui){$.post('/ajax/master/recordSearch',{'query':$("#searchQuery").val(),'selected':ui.item.value},function(data){});$("#searchQuery").val(ui.item.value);$("#searchForm").submit()},}).data("ui-autocomplete")._renderItem=function(ul,item){var label=item.label
var value=item.value
item.value=stripHTMLTags(item.value)
item.value=item.value.replace('&nbsp;','|')
return $("<li></li>").data("item.autocomplete",item).append("<a>"+label+"</a>").appendTo(ul);};var scope=$('#searchScope').val();if((scope=='Parts')||(scope=='Minifigs')||(scope=='Sets')||(scope=='All'))
$("#searchQuery").autocomplete("option","disabled",false);else
$("#searchQuery").autocomplete("option","disabled",true);}
function setupAutocomplete(){autocomplete();$('#searchScope').change(function(){autocomplete();});}
function setupHomePageForms(){$('#signupForm ').submit(function(e){signupForm(e)});}
function setupViewMoreLinks(){$('#viewmorenews').click(function(e){e.preventDefault();$.get("/ajax/homepage/news",function(data){$('#news').append($('<div>'+data+'</div>').hide().fadeIn(500));});return false;});}
function setupHomePageShopping(){$('.content .shopping .retailer').load("/ajax/shopping/header?vendor=amazon");$('.content .shopping .retailernav li').click(function(){$('.content .shopping .retailernav li').removeClass('active');$('.content .shopping .retailer').css("min-height",$('.content .shopping .retailer').height());$('.content .shopping .retailer').load("/ajax/shopping/header?p=&vendor="+$(this).attr('class'));$('.content .shopping .retailer').attr('class','retailer '+$(this).attr('class'));$(this).addClass('active');});}
function setupCountrySelect(){$('.country a').click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"right",at:"left bottom",of:$(this)});$('#ajaxContainer').empty().load("/ajax/master/countrySelect").dialog("open");});}
function setupLoginForm(){$(".loginLink").click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/master/loginForm").dialog("open");});}
function setupSignupForm(){$("#signupLink").click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/master/signupForm").dialog("open");});}
function setupAddTagForm(){$(".addtagLink").click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/sets/"+$(this).attr('href')).dialog("open");});$(".addminifigtagLink").click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/minifigs/"+$(this).attr('href')).dialog("open");});$(".addparttagLink").click(function(e){e.preventDefault();$('#ajaxContainer').dialog("option","position",{my:"center",at:"center",of:window});$('#ajaxContainer').empty().load("/ajax/parts/"+$(this).attr('href')).dialog("open");});}
function showMessage(selector,data){var d=data.split('|',2);var type=d[0];var text=d[1];if($(selector).is(":visible")){$(selector).removeClass('error').removeClass('info');}else{$(selector).hide();}
$(selector).addClass(type).html(text).slideDown();}
function setupHighslide(){hs.graphicsDir='/assets/js/highslide/graphics/';hs.outlineType='rounded-white';hs.wrapperClassName='draggable-header';hs.showCredits=false;hs.forceAjaxReload=true;hs.cacheAjax=false;hs.numberOfImagesToPreload=0;hs.preserveContent=false;hs.minWidth=280;hs.padToMinWidth=true;}
function setupOwnershipControls(){$('input.ownCheckbox').click(function(){var data=this.value.split(';',2);var setID=data[0];var userID=data[1];var own=0;if(userID!=0){if(this.checked)own=1;$.post('/ajax/collection/updateSetOwned',{'setID':setID,'userID':userID,'own':own},function(data){var returnedData=data.split(';',2);var setID=returnedData[0];var own=returnedData[1];if(own==1){$('#own'+setID).addClass('itemowned');$('#qty'+setID).removeAttr('disabled').attr('value','1');$('#acm_'+setID).show();}else{$('#own'+setID).removeClass('itemowned');$('#qty'+setID).attr('disabled','disabled').attr('value','0');$('#acm_'+setID).hide();}});}else
alert(notLoggedIn);return true;});$('input.wantCheckbox').click(function(){var data=this.value.split(';',2);var setID=data[0];var userID=data[1];var want=0;if(userID!=0){if(this.checked)want=1;$.post('/ajax/collection/updateSetWanted',{'setID':setID,'userID':userID,'want':want},function(data){var returnedData=data.split(';',2);var setID=returnedData[0];var want=returnedData[1];if(want==1){$('#want'+setID).addClass('itemwanted');}else{$('#want'+setID).removeClass('itemwanted');}});}else
alert(notLoggedIn);return true;});$('input.flagCheckbox').click(function(){var data=this.value.split(';',3);var setID=data[0];var userID=data[1];var flag=data[2];var value=0;if(userID!=0){if(this.checked)value=1;$.post('/ajax/collection/updateFlag',{'setID':setID,'userID':userID,'value':value,'flag':flag},function(data){var returnedData=data.split(';',3);var setID=returnedData[0];var flag=returnedData[1];var value=returnedData[2];if(value==1){$('#'+flag+'_'+setID).addClass('item'+flag);}else{$('#'+flag+'_'+setID).removeClass('item'+flag);}});}else
alert(notLoggedIn);return true;});$('input.qtyOwned').change(function(){var data=this.name.split(';',2);var setID=data[0];var userID=data[1];if(userID!=0)
$.post('/ajax/collection/updateSetQtyOwned',{'setID':setID,'userID':userID,'qty':this.value},function(data){$('#qty'+setID).addClass('bold');$('#qty'+setID).val(data);})
else
alert(notLoggedIn);});$('input.mfOwnCheckbox').click(function(){var data=this.value.split(';',2);var minifigNumber=data[0];var userID=data[1];var own=0;if(userID!=0){if(this.checked)own=1;$.post('/ajax/collection/updateMinifigCollection',{'minifigNumber':minifigNumber,'userID':userID,'own':own},function(data){var returnedData=data.split(';',2);var minifigNumber=returnedData[0];var own=returnedData[1];if(own==1){$('#own'+minifigNumber).addClass('itemowned');$('#qty'+minifigNumber).removeAttr('disabled').attr('value','1');}else{$('#own'+minifigNumber).removeClass('itemowned');$('#qty'+minifigNumber).attr('disabled','disabled').attr('value','0');}});}else
alert(notLoggedIn);return true;});$('input.mfWantCheckbox').click(function(){var data=this.value.split(';',2);var minifigNumber=data[0];var userID=data[1];var want=0;if(userID!=0){if(this.checked)want=1;$.post('/ajax/collection/updateMinifigCollection',{'minifigNumber':minifigNumber,'userID':userID,'want':want},function(data){var returnedData=data.split(';',2);var minifigNumber=returnedData[0];var want=returnedData[1];if(want==1){$('#want'+minifigNumber).addClass('itemwanted');}else{$('#want'+minifigNumber).removeClass('itemwanted');}});}else
alert(notLoggedIn);return true;});$('input.mfQtyOwned').change(function(){var data=this.name.split(';',2);var minifigNumber=data[0];var userID=data[1];if(userID!=0)
$.post('/ajax/collection/updateMinifigQtyOwned',{'minifigNumber':minifigNumber,'userID':userID,'qty':this.value},function(data){$('#qty'+minifigNumber).addClass('bold');$('#qty'+minifigNumber).val(data);})
else
alert(notLoggedIn);});$('input.partOwnCheckbox').click(function(){var data=this.value.split(';',2);var partID=data[0];var userID=data[1];var own=0;if(userID!=0){if(this.checked)own=1;$.post('/ajax/collection/updatePartsCollection',{'partID':partID,'userID':userID,'own':own},function(data){var returnedData=data.split(';',2);var partNumber=returnedData[0];var own=returnedData[1];if(own==1){$('#own'+partNumber).addClass('itemowned');$('#qty'+partNumber).removeAttr('disabled').attr('value','1');}else{$('#own'+partNumber).removeClass('itemowned');$('#qty'+partNumber).attr('disabled','disabled').attr('value','0');}});}else
alert(notLoggedIn);return true;});$('input.partWantCheckbox').click(function(){var data=this.value.split(';',2);var partID=data[0];var userID=data[1];var want=0;if(userID!=0){if(this.checked)want=1;$.post('/ajax/collection/updatePartsCollection',{'partID':partID,'userID':userID,'want':want},function(data){var returnedData=data.split(';',2);var partNumber=returnedData[0];var want=returnedData[1];if(want==1){$('#want'+partNumber).addClass('itemwanted');$('#qtyw'+partNumber).removeAttr('disabled').attr('value','1');}else{$('#want'+partNumber).removeClass('itemwanted');$('#qtyw'+partNumber).attr('disabled','disabled').attr('value','0');}});}else
alert(notLoggedIn);return true;});$('input.partQtyOwned').change(function(){var data=this.name.split(';',2);var partID=data[0];var userID=data[1];if(userID!=0)
$.post('/ajax/collection/updatePartsQtyOwned',{'partID':partID,'userID':userID,'qty':this.value},function(data){$('#qty'+partID).addClass('bold');$('#qty'+partID).val(data);})
else
alert(notLoggedIn);});$('input.partQtyWanted').change(function(){var data=this.name.split(';',2);var partID=data[0];var userID=data[1];if(userID!=0)
$.post('/ajax/collection/updatePartsQtyWanted',{'partID':partID,'userID':userID,'qty':this.value},function(data){$('#qtyw'+partID).addClass('bold');$('#qtyw'+partID).val(data);})
else
alert(notLoggedIn);});$('input.releasedCheckbox').click(function(){var data=this.value.split(';',2);var setID=data[0];var userID=data[1];$.post('/webhandlers/setIsReleased.ashx',{'setID':setID,'userID':userID},function(data){});});$('input.imageCheckbox').click(function(){var data=this.value.split(';',2);var setID=data[0];var userID=data[1];$.post('/webhandlers/setHasImage.ashx',{'setID':setID,'userID':userID},function(data){});});$('input.notesSave').click(function(){var data=this.name.split(';',2);var setID=data[0];var userID=data[1];var notes=document.getElementById('ta'+this.name).value;$.post('/ajax/collection/updateNotes',{'setID':setID,'userID':userID,'notes':notes},function(data){$('#nt'+data).slideUp().html('<p>Your note has been saved.</p>').addClass('info').slideDown(50);});});$('a.acmlink').click(function(e){e.preventDefault;e.stopPropagation;var data=this.id.split('_')
var setID=data[1]
$(this).attr('href','/ajax/acm/acm?setid='+setID);hs.htmlExpand(this,{objectType:'iframe',width:Math.min(1280,$(window).width()-50)})
return false;});$('a.bricklistlink').click(function(e){e.preventDefault;e.stopPropagation;var data=this.id.split('_')
var setID=data[1]
$(this).attr('href','/ajax/sets/addToBricklist?setid='+setID);hs.htmlExpand(this,{objectType:'iframe',width:Math.min(600,$(window).width()-50)})
return false;});$('a.popuplink').click(function(e){e.preventDefault();$("#ajaxContainer").dialog("option","title",'');$('#ajaxContainer').dialog("option","position",{my:'left top',at:'left bottom',of:$(this)});$('#ajaxContainer').empty().load("/ajax/sets/"+$(this).attr('href')).dialog("open");});}
function setupReviewRatings(){$('input.yesRadio, input.noRadio').click(function(){var data=this.value.split(';',3);var rating=data[0];var reviewID=data[1];var userID=data[2];if(userID!=0)
$.get('/webhandlers/rateReview.ashx',{'rating':rating,'userID':userID,'reviewID':reviewID},function(data){$("#confirm"+reviewID).html(data)});else
alert(notLoggedIn);});}
function setupSetRatings(){$('.setrating').barrating({theme:'css-stars',allowEmpty:true,silent:true,deselectable:true,onSelect:function(value,text,event){var data=text.split(';',3);var rating=data[0];var setID=data[1];var userID=data[2];if(userID!=0)
$.get('/webhandlers/rateSet.ashx',{'rating':rating,'userID':userID,'setID':setID},function(data){});else
alert(notLoggedIn);},});}
function setupBricklistRatings(){$('input.brickListYesRadio, input.brickListNoRadio').click(function(){var data=this.value.split(';',3);var rating=data[0];var listID=data[1];var userID=data[2];if(userID!=0)
$.get('/webhandlers/rateBricklist.ashx',{'rating':rating,'userID':userID,'listID':listID},function(data){$("#confirm"+listID).html(data)});else
alert(notLoggedIn);});}
function setupVideoReviews(){$("#videoframe div.outer").hide();$("#videoframe div.outer p").hide();$("#videoframe div#v1").show();$("#meta").html(($("#mv1").html()))
$("#publisherlist h3").click(function(){var state=$("#publisherlist ul#ul"+this.id).is(":visible")
if(state==true)
$("#publisherlist ul#ul"+this.id).slideUp();else{$("#publisherlist ul").slideUp();$("#publisherlist ul#ul"+this.id).slideDown();}
return true;});$("#videoreviews li").click(function(){$("#videoframe div.outer").hide();var data=this.id.split(':',3);var vid=data[1];var videoID=data[2]
var args=new Array(videoID);callPlayer("iframe1","stopVideo")
callPlayer("iframe1","loadVideoById",args);$("#"+vid).show();$("#meta").html(($("#m"+vid).html()))
return true;});}
function setupReviewAdmin(){$('body.reviews a.delreview').click(function(e){e.preventDefault();e.stopPropagation();if(window.confirm("Click OK confirm you want to delete this review.")){var id=right(this.id,this.id.length-1)
$.post('/WebHandlers/delReview.ashx',{'reviewID':id},function(data){$("#review"+id).fadeOut();});}
return false;});$('body.reviews a.rejectreview').click(function(e){e.preventDefault();e.stopPropagation();if(window.confirm("Click OK confirm you want to reject this review.")){var id=right(this.id,this.id.length-1)
$.post('/WebHandlers/rejectReview.ashx',{'reviewID':id},function(data){$("#review"+id).fadeOut();});}
return false;});}
function setupBrickListAdmin(){$('body.bricklists a.delbricklist').click(function(e){e.preventDefault();e.stopPropagation();if(window.confirm("Click OK confirm you want to delete this BrickList.")){var id=right(this.id,this.id.length-1)
$.post('/WebHandlers/delBrickList.ashx',{'listID':id},function(data){$("#bricklist"+id).fadeOut();});}
return false;});}
function setupQueryAdmin(){$('body.queries a.delquery').click(function(e){e.preventDefault();e.stopPropagation();if(window.confirm("Click OK confirm you want to delete this query.")){var id=right(this.id,this.id.length-1)
$.post('/WebHandlers/delQuery.ashx',{'queryID':id},function(data){$("#query"+id).fadeOut();});}
return false;});}
function setupSetNumberInput(){$("input.setnumber").autocomplete({source:function(request,response){$.ajax({url:"/ajax/autocomplete/setsForEdit.aspx",data:"q="+request.term,dataType:"json",type:"GET",contentType:"application/json; charset=utf-8",dataFilter:function(data){return data;},success:function(data){response(data.d.split(","));},error:function(){}});},minLength:3});}
function setupMinifigNameInput(){$("input.minifigname").autocomplete({source:function(request,response){$.ajax({url:"/ajax/autocomplete/minifignames.aspx",data:"q="+request.term,dataType:"json",type:"GET",contentType:"application/json; charset=utf-8",dataFilter:function(data){return data;},success:function(data){response(data.d.split(","));},error:function(){}});},minLength:3});}
function setupUserInput(){$("input.username").autocomplete({source:function(request,response){$.ajax({url:"/ajax/autocomplete/users",data:"q="+request.term,dataType:"json",type:"GET",contentType:"application/json; charset=utf-8",dataFilter:function(data){return data;},success:function(data){response(data.d.split(","));},error:function(){}});},minLength:3});}
function stripHTMLTags(str){if((str===null)||(str===''))
return false;else
str=str.toString();return str.replace(/<[^>]*>/g,'');}
function callPlayer(frame_id,func,args){if(window.jQuery&&frame_id instanceof jQuery)frame_id=frame_id.get(0).id;var iframe=document.getElementById(frame_id);if(iframe&&iframe.tagName.toUpperCase()!='IFRAME'){iframe=iframe.getElementsByTagName('iframe')[0];}
if(iframe){iframe.contentWindow.postMessage(JSON.stringify({"event":"command","func":func,"args":args||[],"id":frame_id}),"*");}}
function left(str,n){if(n<=0)
return "";else if(n>String(str).length)
return str;else
return String(str).substring(0,n);}
function right(str,n){if(n<=0)
return "";else if(n>String(str).length)
return str;else{var iLen=String(str).length;return String(str).substring(iLen,iLen-n);}}
(function($){$.extend({tablesorter:new
function(){var parsers=[],widgets=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:true,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:false,cancelSelection:true,sortList:[],headerList:[],dateFormat:"us",decimal:'/\.|\,/g',onRenderHeader:null,selectorHeaders:'thead th',debug:false};function benchmark(s,d){log(s+","+(new Date().getTime()-d.getTime())+"ms");}this.benchmark=benchmark;function log(s){if(typeof console!="undefined"&&typeof console.debug!="undefined"){console.log(s);}else{alert(s);}}function buildParserCache(table,$headers){if(table.config.debug){var parsersDebug="";}if(table.tBodies.length==0)return;var rows=table.tBodies[0].rows;if(rows[0]){var list=[],cells=rows[0].cells,l=cells.length;for(var i=0;i<l;i++){var p=false;if($.metadata&&($($headers[i]).metadata()&&$($headers[i]).metadata().sorter)){p=getParserById($($headers[i]).metadata().sorter);}else if((table.config.headers[i]&&table.config.headers[i].sorter)){p=getParserById(table.config.headers[i].sorter);}if(!p){p=detectParserForColumn(table,rows,-1,i);}if(table.config.debug){parsersDebug+="column:"+i+" parser:"+p.id+"\n";}list.push(p);}}if(table.config.debug){log(parsersDebug);}return list;};function detectParserForColumn(table,rows,rowIndex,cellIndex){var l=parsers.length,node=false,nodeValue=false,keepLooking=true;while(nodeValue==''&&keepLooking){rowIndex++;if(rows[rowIndex]){node=getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex);nodeValue=trimAndGetNodeText(table.config,node);if(table.config.debug){log('Checking if value was empty on row:'+rowIndex);}}else{keepLooking=false;}}for(var i=1;i<l;i++){if(parsers[i].is(nodeValue,table,node)){return parsers[i];}}return parsers[0];}function getNodeFromRowAndCellIndex(rows,rowIndex,cellIndex){return rows[rowIndex].cells[cellIndex];}function trimAndGetNodeText(config,node){return $.trim(getElementText(config,node));}function getParserById(name){var l=parsers.length;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==name.toLowerCase()){return parsers[i];}}return false;}function buildCache(table){if(table.config.debug){var cacheTime=new Date();}var totalRows=(table.tBodies[0]&&table.tBodies[0].rows.length)||0,totalCells=(table.tBodies[0].rows[0]&&table.tBodies[0].rows[0].cells.length)||0,parsers=table.config.parsers,cache={row:[],normalized:[]};for(var i=0;i<totalRows;++i){var c=$(table.tBodies[0].rows[i]),cols=[];if(c.hasClass(table.config.cssChildRow)){cache.row[cache.row.length-1]=cache.row[cache.row.length-1].add(c);continue;}cache.row.push(c);for(var j=0;j<totalCells;++j){cols.push(parsers[j].format(getElementText(table.config,c[0].cells[j]),table,c[0].cells[j]));}cols.push(cache.normalized.length);cache.normalized.push(cols);cols=null;};if(table.config.debug){benchmark("Building cache for "+totalRows+" rows:",cacheTime);}return cache;};function getElementText(config,node){var text="";if(!node)return "";if(!config.supportsTextContent)config.supportsTextContent=node.textContent||false;if(config.textExtraction=="simple"){if(config.supportsTextContent){text=node.textContent;}else{if(node.childNodes[0]&&node.childNodes[0].hasChildNodes()){text=node.childNodes[0].innerHTML;}else{text=node.innerHTML;}}}else{if(typeof(config.textExtraction)=="function"){text=config.textExtraction(node);}else{text=$(node).text();}}return text;}function appendToTable(table,cache){if(table.config.debug){var appendTime=new Date()}var c=cache,r=c.row,n=c.normalized,totalRows=n.length,checkCell=(n[0].length-1),tableBody=$(table.tBodies[0]),rows=[];for(var i=0;i<totalRows;i++){var pos=n[i][checkCell];rows.push(r[pos]);if(!table.config.appender){var l=r[pos].length;for(var j=0;j<l;j++){tableBody[0].appendChild(r[pos][j]);}}}if(table.config.appender){table.config.appender(table,rows);}rows=null;if(table.config.debug){benchmark("Rebuilt table:",appendTime);}applyWidget(table);setTimeout(function(){$(table).trigger("sortEnd");},0);};function buildHeaders(table){if(table.config.debug){var time=new Date();}var meta=($.metadata)?true:false;var header_index=computeTableHeaderCellIndexes(table);$tableHeaders=$(table.config.selectorHeaders,table).each(function(index){this.column=header_index[this.parentNode.rowIndex+"-"+this.cellIndex];this.order=formatSortingOrder(table.config.sortInitialOrder);this.count=this.order;if(checkHeaderMetadata(this)||checkHeaderOptions(table,index))this.sortDisabled=true;if(checkHeaderOptionsSortingLocked(table,index))this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(table,index);if(!this.sortDisabled){var $th=$(this).addClass(table.config.cssHeader);if(table.config.onRenderHeader)table.config.onRenderHeader.apply($th);}table.config.headerList[index]=this;});if(table.config.debug){benchmark("Built headers:",time);log($tableHeaders);}return $tableHeaders;};function computeTableHeaderCellIndexes(t){var matrix=[];var lookup={};var thead=t.getElementsByTagName('THEAD')[0];var trs=thead.getElementsByTagName('TR');for(var i=0;i<trs.length;i++){var cells=trs[i].cells;for(var j=0;j<cells.length;j++){var c=cells[j];var rowIndex=c.parentNode.rowIndex;var cellId=rowIndex+"-"+c.cellIndex;var rowSpan=c.rowSpan||1;var colSpan=c.colSpan||1
var firstAvailCol;if(typeof(matrix[rowIndex])=="undefined"){matrix[rowIndex]=[];}for(var k=0;k<matrix[rowIndex].length+1;k++){if(typeof(matrix[rowIndex][k])=="undefined"){firstAvailCol=k;break;}}lookup[cellId]=firstAvailCol;for(var k=rowIndex;k<rowIndex+rowSpan;k++){if(typeof(matrix[k])=="undefined"){matrix[k]=[];}var matrixrow=matrix[k];for(var l=firstAvailCol;l<firstAvailCol+colSpan;l++){matrixrow[l]="x";}}}}return lookup;}function checkCellColSpan(table,rows,row){var arr=[],r=table.tHead.rows,c=r[row].cells;for(var i=0;i<c.length;i++){var cell=c[i];if(cell.colSpan>1){arr=arr.concat(checkCellColSpan(table,headerArr,row++));}else{if(table.tHead.length==1||(cell.rowSpan>1||!r[row+1])){arr.push(cell);}}}return arr;};function checkHeaderMetadata(cell){if(($.metadata)&&($(cell).metadata().sorter===false)){return true;};return false;}function checkHeaderOptions(table,i){if((table.config.headers[i])&&(table.config.headers[i].sorter===false)){return true;};return false;}function checkHeaderOptionsSortingLocked(table,i){if((table.config.headers[i])&&(table.config.headers[i].lockedOrder))return table.config.headers[i].lockedOrder;return false;}function applyWidget(table){var c=table.config.widgets;var l=c.length;for(var i=0;i<l;i++){getWidgetById(c[i]).format(table);}}function getWidgetById(name){var l=widgets.length;for(var i=0;i<l;i++){if(widgets[i].id.toLowerCase()==name.toLowerCase()){return widgets[i];}}};function formatSortingOrder(v){if(typeof(v)!="Number"){return(v.toLowerCase()=="desc")?1:0;}else{return(v==1)?1:0;}}function isValueInArray(v,a){var l=a.length;for(var i=0;i<l;i++){if(a[i][0]==v){return true;}}return false;}function setHeadersCss(table,$headers,list,css){$headers.removeClass(css[0]).removeClass(css[1]);var h=[];$headers.each(function(offset){if(!this.sortDisabled){h[this.column]=$(this);}});var l=list.length;for(var i=0;i<l;i++){h[list[i][0]].addClass(css[list[i][1]]);}}function fixColumnWidth(table,$headers){var c=table.config;if(c.widthFixed){var colgroup=$('<colgroup>');$("tr:first td",table.tBodies[0]).each(function(){colgroup.append($('<col>').css('width',$(this).width()));});$(table).prepend(colgroup);};}function updateHeaderSortCount(table,sortList){var c=table.config,l=sortList.length;for(var i=0;i<l;i++){var s=sortList[i],o=c.headerList[s[0]];o.count=s[1];o.count++;}}function multisort(table,sortList,cache){if(table.config.debug){var sortTime=new Date();}var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length;for(var i=0;i<l;i++){var c=sortList[i][0];var order=sortList[i][1];var s=(table.config.parsers[c].type=="text")?((order==0)?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c)):((order==0)?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c));var e="e"+i;dynamicExp+="var "+e+" = "+s;dynamicExp+="if("+e+") { return "+e+"; } ";dynamicExp+="else { ";}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++){dynamicExp+="}; ";}dynamicExp+="return 0; ";dynamicExp+="}; ";if(table.config.debug){benchmark("Evaling expression:"+dynamicExp,new Date());}eval(dynamicExp);cache.normalized.sort(sortWrapper);if(table.config.debug){benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime);}return cache;};function makeSortFunction(type,direction,index){var a="a["+index+"]",b="b["+index+"]";if(type=='text'&&direction=='asc'){return "("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+b+") ? -1 : 1 )));";}else if(type=='text'&&direction=='desc'){return "("+a+" == "+b+" ? 0 : ("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : ("+b+" < "+a+") ? -1 : 1 )));";}else if(type=='numeric'&&direction=='asc'){return "("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+b+"));";}else if(type=='numeric'&&direction=='desc'){return "("+a+" === null && "+b+" === null) ? 0 :("+a+" === null ? Number.POSITIVE_INFINITY : ("+b+" === null ? Number.NEGATIVE_INFINITY : "+b+" - "+a+"));";}};function makeSortText(i){return "((a["+i+"] < b["+i+"]) ? -1 : ((a["+i+"] > b["+i+"]) ? 1 : 0));";};function makeSortTextDesc(i){return "((b["+i+"] < a["+i+"]) ? -1 : ((b["+i+"] > a["+i+"]) ? 1 : 0));";};function makeSortNumeric(i){return "a["+i+"]-b["+i+"];";};function makeSortNumericDesc(i){return "b["+i+"]-a["+i+"];";};function sortText(a,b){if(table.config.sortLocaleCompare)return a.localeCompare(b);return((a<b)?-1:((a>b)?1:0));};function sortTextDesc(a,b){if(table.config.sortLocaleCompare)return b.localeCompare(a);return((b<a)?-1:((b>a)?1:0));};function sortNumeric(a,b){return a-b;};function sortNumericDesc(a,b){return b-a;};function getCachedSortType(parsers,i){return parsers[i].type;};this.construct=function(settings){return this.each(function(){if(!this.tHead||!this.tBodies)return;var $this,$document,$headers,cache,config,shiftDown=0,sortOrder;this.config={};config=$.extend(this.config,$.tablesorter.defaults,settings);$this=$(this);$.data(this,"tablesorter",config);$headers=buildHeaders(this);this.config.parsers=buildParserCache(this,$headers);cache=buildCache(this);var sortCSS=[config.cssDesc,config.cssAsc];fixColumnWidth(this);$headers.click(function(e){var totalRows=($this[0].tBodies[0]&&$this[0].tBodies[0].rows.length)||0;if(!this.sortDisabled&&totalRows>0){$this.trigger("sortStart");var $cell=$(this);var i=this.column;this.order=this.count++%2;if(this.lockedOrder)this.order=this.lockedOrder;if(!e[config.sortMultiSortKey]){config.sortList=[];if(config.sortForce!=null){var a=config.sortForce;for(var j=0;j<a.length;j++){if(a[j][0]!=i){config.sortList.push(a[j]);}}}config.sortList.push([i,this.order]);}else{if(isValueInArray(i,config.sortList)){for(var j=0;j<config.sortList.length;j++){var s=config.sortList[j],o=config.headerList[s[0]];if(s[0]==i){o.count=s[1];o.count++;s[1]=o.count%2;}}}else{config.sortList.push([i,this.order]);}};setTimeout(function(){setHeadersCss($this[0],$headers,config.sortList,sortCSS);appendToTable($this[0],multisort($this[0],config.sortList,cache));},1);return false;}}).mousedown(function(){if(config.cancelSelection){this.onselectstart=function(){return false};return false;}});$this.bind("update",function(){var me=this;setTimeout(function(){me.config.parsers=buildParserCache(me,$headers);cache=buildCache(me);},1);}).bind("updateCell",function(e,cell){var config=this.config;var pos=[(cell.parentNode.rowIndex-1),cell.cellIndex];cache.normalized[pos[0]][pos[1]]=config.parsers[pos[1]].format(getElementText(config,cell),cell);}).bind("sorton",function(e,list){$(this).trigger("sortStart");config.sortList=list;var sortList=config.sortList;updateHeaderSortCount(this,sortList);setHeadersCss(this,$headers,sortList,sortCSS);appendToTable(this,multisort(this,sortList,cache));}).bind("appendCache",function(){appendToTable(this,cache);}).bind("applyWidgetId",function(e,id){getWidgetById(id).format(this);}).bind("applyWidgets",function(){applyWidget(this);});if($.metadata&&($(this).metadata()&&$(this).metadata().sortlist)){config.sortList=$(this).metadata().sortlist;}if(config.sortList.length>0){$this.trigger("sorton",[config.sortList]);}applyWidget(this);});};this.addParser=function(parser){var l=parsers.length,a=true;for(var i=0;i<l;i++){if(parsers[i].id.toLowerCase()==parser.id.toLowerCase()){a=false;}}if(a){parsers.push(parser);};};this.addWidget=function(widget){widgets.push(widget);};this.formatFloat=function(s){var i=parseFloat(s);return(isNaN(i))?0:i;};this.formatInt=function(s){var i=parseInt(s);return(isNaN(i))?0:i;};this.isDigit=function(s,config){return /^[-+]?\d*$/.test($.trim(s.replace(/[,.']/g,'')));};this.clearTableBody=function(table){if($.browser.msie){function empty(){while(this.firstChild)this.removeChild(this.firstChild);}empty.apply(table.tBodies[0]);}else{table.tBodies[0].innerHTML="";}};}});$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(s){return true;},format:function(s){return $.trim(s.toLocaleLowerCase());},type:"text"});ts.addParser({id:"digit",is:function(s,table){var c=table.config;return $.tablesorter.isDigit(s,c);},format:function(s){return $.tablesorter.formatFloat(s);},type:"numeric"});ts.addParser({id:"currency",is:function(s){return /^[£$€?.]/.test(s);},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/[£$€]/g),""));},type:"numeric"});ts.addParser({id:"ipAddress",is:function(s){return /^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(s);},format:function(s){var a=s.split("."),r="",l=a.length;for(var i=0;i<l;i++){var item=a[i];if(item.length==2){r+="0"+item;}else{r+=item;}}return $.tablesorter.formatFloat(r);},type:"numeric"});ts.addParser({id:"url",is:function(s){return /^(https?|ftp|file):\/\/$/.test(s);},format:function(s){return jQuery.trim(s.replace(new RegExp(/(https?|ftp|file):\/\//),''));},type:"text"});ts.addParser({id:"isoDate",is:function(s){return /^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(s);},format:function(s){return $.tablesorter.formatFloat((s!="")?new Date(s.replace(new RegExp(/-/g),"/")).getTime():"0");},type:"numeric"});ts.addParser({id:"percent",is:function(s){return /\%$/.test($.trim(s));},format:function(s){return $.tablesorter.formatFloat(s.replace(new RegExp(/%/g),""));},type:"numeric"});ts.addParser({id:"usLongDate",is:function(s){return s.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/));},format:function(s){return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"shortDate",is:function(s){return /\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(s);},format:function(s,table){var c=table.config;s=s.replace(/\-/g,"/");if(c.dateFormat=="us"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");}else if(c.dateFormat=="uk"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");}else if(c.dateFormat=="dd/mm/yy"||c.dateFormat=="dd-mm-yy"){s=s.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");}return $.tablesorter.formatFloat(new Date(s).getTime());},type:"numeric"});ts.addParser({id:"time",is:function(s){return /^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(s);},format:function(s){return $.tablesorter.formatFloat(new Date("2000/01/01 "+s).getTime());},type:"numeric"});ts.addParser({id:"metadata",is:function(s){return false;},format:function(s,table,cell){var c=table.config,p=(!c.parserMetadataName)?'sortValue':c.parserMetadataName;return $(cell).metadata()[p];},type:"numeric"});ts.addWidget({id:"zebra",format:function(table){if(table.config.debug){var time=new Date();}var $tr,row=-1,odd;$("tr:visible",table.tBodies[0]).each(function(i){$tr=$(this);if(!$tr.hasClass(table.config.cssChildRow))row++;odd=(row%2==0);$tr.removeClass(table.config.widgetZebra.css[odd?0:1]).addClass(table.config.widgetZebra.css[odd?1:0])});if(table.config.debug){$.tablesorter.benchmark("Applying Zebra widget",time);}}});})(jQuery);(function(a,b){var c=a(b);a.fn.lazyload=function(d){function h(){var b=0;e.each(function(){var c=a(this);if(g.skip_invisible&&!c.is(":visible"))return;if(!a.abovethetop(this,g)&&!a.leftofbegin(this,g))if(!a.belowthefold(this,g)&&!a.rightoffold(this,g))c.trigger("appear");else if(++b>g.failure_limit)return!1})}var e=this,f,g={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null};return d&&(undefined!==d.failurelimit&&(d.failure_limit=d.failurelimit,delete d.failurelimit),undefined!==d.effectspeed&&(d.effect_speed=d.effectspeed,delete d.effectspeed),a.extend(g,d)),f=g.container===undefined||g.container===b?c:a(g.container),0===g.event.indexOf("scroll")&&f.bind(g.event,function(a){return h()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,c.one("appear",function(){if(!this.loaded){if(g.appear){var d=e.length;g.appear.call(b,d,g)}a("<img />").bind("load",function(){c.hide().attr("src",c.data(g.data_attribute))[g.effect](g.effect_speed),b.loaded=!0;var d=a.grep(e,function(a){return!a.loaded});e=a(d);if(g.load){var f=e.length;g.load.call(b,f,g)}}).attr("src",c.data(g.data_attribute))}}),0!==g.event.indexOf("scroll")&&c.bind(g.event,function(a){b.loaded||c.trigger("appear")})}),c.bind("resize",function(a){h()}),h(),this},a.belowthefold=function(d,e){var f;return e.container===undefined||e.container===b?f=c.height()+c.scrollTop():f=a(e.container).offset().top+a(e.container).height(),f<=a(d).offset().top-e.threshold},a.rightoffold=function(d,e){var f;return e.container===undefined||e.container===b?f=c.width()+c.scrollLeft():f=a(e.container).offset().left+a(e.container).width(),f<=a(d).offset().left-e.threshold},a.abovethetop=function(d,e){var f;return e.container===undefined||e.container===b?f=c.scrollTop():f=a(e.container).offset().top,f>=a(d).offset().top+e.threshold+a(d).height()},a.leftofbegin=function(d,e){var f;return e.container===undefined||e.container===b?f=c.scrollLeft():f=a(e.container).offset().left,f>=a(d).offset().left+e.threshold+a(d).width()},a.inviewport=function(b,c){return!a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return!a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})})(jQuery,window);(function(a){a.fn.nmcDropDown=function(b){var c=a.extend({},a.fn.nmcDropDown.defaults,b);return this.each(function(){menu=a(this);submenus=menu.children("li:has("+c.submenu_selector+")");if(c.fix_IE){menu.css("z-index",51).parents().each(function(d){if(a(this).css("position")=="relative"){a(this).css("z-index",(d+52))}});submenus.children(c.submenu_selector).css("z-index",50)}over=function(){a(this).addClass(c.active_class).children(c.submenu_selector).animate(c.show,c.show_speed);return false};out=function(){a(this).removeClass(c.active_class).children(c.submenu_selector).animate(c.hide,c.hide_speed);return false};if(c.trigger=="click"){submenus.toggle(over,out).children(c.submenu_selector).hide()}else{if(a().hoverIntent){submenus.hoverIntent({interval:c.show_delay,over:over,timeout:c.hide_delay,out:out}).children(c.submenu_selector).hide()}else{submenus.hover(over,out).children(c.submenu_selector).hide()}}})};a.fn.nmcDropDown.defaults={trigger:"hover",active_class:"open",submenu_selector:"ul",show:{opacity:"show"},show_speed:300,show_delay:50,hide:{opacity:"hide"},hide_speed:200,hide_delay:100,fix_IE:true}})(jQuery);var __slice=[].slice,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(function(e,t){var n;return n=function(){function t(t,n){var r,i=this;this.input=t,this.defaultOptions={animate:!0,snapMid:!1,classPrefix:null,classSuffix:null,theme:null,highlight:!1},this.settings=e.extend({},this.defaultOptions,n),this.settings.theme&&(this.settings.classSuffix="-"+this.settings.theme),this.input.hide(),this.slider=e("<div>").addClass("slider"+(this.settings.classSuffix||"")).css({position:"relative",userSelect:"none",boxSizing:"border-box"}).insertBefore(this.input),this.input.attr("id")&&this.slider.attr("id",this.input.attr("id")+"-slider"),this.track=this.createDivElement("track").css({width:"100%"}),this.settings.highlight&&(this.highlightTrack=this.createDivElement("highlight-track").css({width:"0"})),this.dragger=this.createDivElement("dragger"),this.slider.css({minHeight:this.dragger.outerHeight(),marginLeft:this.dragger.outerWidth()/2,marginRight:this.dragger.outerWidth()/2}),this.track.css({marginTop:this.track.outerHeight()/-2}),this.settings.highlight&&this.highlightTrack.css({marginTop:this.track.outerHeight()/-2}),this.dragger.css({marginTop:this.dragger.outerWidth()/-2,marginLeft:this.dragger.outerWidth()/-2}),this.track.mousedown(function(e){return i.trackEvent(e)}),this.settings.highlight&&this.highlightTrack.mousedown(function(e){return i.trackEvent(e)}),this.dragger.mousedown(function(e){if(e.which!==1)return;return i.dragging=!0,i.dragger.addClass("dragging"),i.domDrag(e.pageX,e.pageY),!1}),e("body").mousemove(function(t){if(i.dragging)return i.domDrag(t.pageX,t.pageY),e("body").css({cursor:"pointer"})}).mouseup(function(t){if(i.dragging)return i.dragging=!1,i.dragger.removeClass("dragging"),e("body").css({cursor:"auto"})}),this.pagePos=0,this.input.val()===""?(this.value=this.getRange().min,this.input.val(this.value)):this.value=this.nearestValidValue(this.input.val()),this.setSliderPositionFromValue(this.value),r=this.valueToRatio(this.value),this.input.trigger("slider:ready",{value:this.value,ratio:r,position:r*this.slider.outerWidth(),el:this.slider})}return t.prototype.createDivElement=function(t){var n;return n=e("<div>").addClass(t).css({position:"absolute",top:"50%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider),n},t.prototype.setRatio=function(e){var t;return e=Math.min(1,e),e=Math.max(0,e),t=this.ratioToValue(e),this.setSliderPositionFromValue(t),this.valueChanged(t,e,"setRatio")},t.prototype.setValue=function(e){var t;return e=this.nearestValidValue(e),t=this.valueToRatio(e),this.setSliderPositionFromValue(e),this.valueChanged(e,t,"setValue")},t.prototype.trackEvent=function(e){if(e.which!==1)return;return this.domDrag(e.pageX,e.pageY,!0),this.dragging=!0,!1},t.prototype.domDrag=function(e,t,n){var r,i,s;n==null&&(n=!1),r=e-this.slider.offset().left,r=Math.min(this.slider.outerWidth(),r),r=Math.max(0,r);if(this.pagePos!==r)return this.pagePos=r,i=r/this.slider.outerWidth(),s=this.ratioToValue(i),this.valueChanged(s,i,"domDrag"),this.settings.snap?this.setSliderPositionFromValue(s,n):this.setSliderPosition(r,n)},t.prototype.setSliderPosition=function(e,t){t==null&&(t=!1);if(t&&this.settings.animate){this.dragger.animate({left:e},200);if(this.settings.highlight)return this.highlightTrack.animate({width:e},200)}else{this.dragger.css({left:e});if(this.settings.highlight)return this.highlightTrack.css({width:e})}},t.prototype.setSliderPositionFromValue=function(e,t){var n;return t==null&&(t=!1),n=this.valueToRatio(e),this.setSliderPosition(n*this.slider.outerWidth(),t)},t.prototype.getRange=function(){return this.settings.allowedValues?{min:Math.min.apply(Math,this.settings.allowedValues),max:Math.max.apply(Math,this.settings.allowedValues)}:this.settings.range?{min:parseFloat(this.settings.range[0]),max:parseFloat(this.settings.range[1])}:{min:0,max:1}},t.prototype.nearestValidValue=function(t){var n,r,i,s;return i=this.getRange(),t=Math.min(i.max,t),t=Math.max(i.min,t),this.settings.allowedValues?(n=null,e.each(this.settings.allowedValues,function(){if(n===null||Math.abs(this-t)<Math.abs(n-t))return n=this}),n):this.settings.step?(r=(i.max-i.min)/this.settings.step,s=Math.floor((t-i.min)/this.settings.step),(t-i.min)%this.settings.step>this.settings.step/2&&s<r&&(s+=1),s*this.settings.step+i.min):t},t.prototype.valueToRatio=function(e){var t,n,r,i,s,o,u,a;if(this.settings.equalSteps){a=this.settings.allowedValues;for(i=o=0,u=a.length;o<u;i=++o){t=a[i];if(typeof n=="undefined"||n===null||Math.abs(t-e)<Math.abs(n-e))n=t,r=i}return this.settings.snapMid?(r+.5)/this.settings.allowedValues.length:r/(this.settings.allowedValues.length-1)}return s=this.getRange(),(e-s.min)/(s.max-s.min)},t.prototype.ratioToValue=function(e){var t,n,r,i,s;return this.settings.equalSteps?(s=this.settings.allowedValues.length,i=Math.round(e*s-.5),t=Math.min(i,this.settings.allowedValues.length-1),this.settings.allowedValues[t]):(n=this.getRange(),r=e*(n.max-n.min)+n.min,this.nearestValidValue(r))},t.prototype.valueChanged=function(t,n,r){var i;if(t.toString()===this.value.toString())return;return this.value=t,i={value:t,ratio:n,position:n*this.slider.outerWidth(),trigger:r,el:this.slider},this.input.val(t).trigger(e.Event("change",i)).trigger("slider:changed",i)},t}(),e.extend(e.fn,{simpleSlider:function(){var t,r,i;return i=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],r=["setRatio","setValue"],e(this).each(function(){var s,o;return i&&__indexOf.call(r,i)>=0?(s=e(this).data("slider-object"),s[i].apply(s,t)):(o=i,e(this).data("slider-object",new n(e(this),o)))})}}),e(function(){return e("[data-slider]").each(function(){var t,n,r,i;return t=e(this),r={},n=t.data("slider-values"),n&&(r.allowedValues=function(){var e,t,r,s;r=n.split(","),s=[];for(e=0,t=r.length;e<t;e++)i=r[e],s.push(parseFloat(i));return s}()),t.data("slider-range")&&(r.range=t.data("slider-range").split(",")),t.data("slider-step")&&(r.step=t.data("slider-step")),r.snap=t.data("slider-snap"),r.equalSteps=t.data("slider-equal-steps"),t.data("slider-theme")&&(r.theme=t.data("slider-theme")),t.attr("data-slider-highlight")&&(r.highlight=t.data("slider-highlight")),t.data("slider-animate")!=null&&(r.animate=t.data("slider-animate")),t.simpleSlider(r)})})})(this.jQuery||this.Zepto,this);function urlencode(str){str=(str+'').toString();return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');}
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e=function(){function e(){var e=this,n=function(){var n=["br-wrapper"];""!==e.options.theme&&n.push("br-theme-"+e.options.theme),e.$elem.wrap(t("<div />",{"class":n.join(" ")}))},i=function(){e.$elem.unwrap()},a=function(n){return t.isNumeric(n)&&(n=Math.floor(n)),t('option[value="'+n+'"]',e.$elem)},r=function(){var n=e.options.initialRating;return n?a(n):t("option:selected",e.$elem)},o=function(){var n=e.$elem.find('option[value="'+e.options.emptyValue+'"]');return!n.length&&e.options.allowEmpty?(n=t("<option />",{value:e.options.emptyValue}),n.prependTo(e.$elem)):n},l=function(t){var n=e.$elem.data("barrating");return "undefined"!=typeof t?n[t]:n},s=function(t,n){null!==n&&"object"==typeof n?e.$elem.data("barrating",n):e.$elem.data("barrating")[t]=n},u=function(){var t=r(),n=o(),i=t.val(),a=t.data("html")?t.data("html"):t.text(),l=null!==e.options.allowEmpty?e.options.allowEmpty:!!n.length,u=n.length?n.val():null,d=n.length?n.text():null;s(null,{userOptions:e.options,ratingValue:i,ratingText:a,originalRatingValue:i,originalRatingText:a,allowEmpty:l,emptyRatingValue:u,emptyRatingText:d,readOnly:e.options.readonly,ratingMade:!1})},d=function(){e.$elem.removeData("barrating")},c=function(){return l("ratingText")},f=function(){return l("ratingValue")},g=function(){var n=t("<div />",{"class":"br-widget"});return e.$elem.find("option").each(function(){var i,a,r,o;i=t(this).val(),i!==l("emptyRatingValue")&&(a=t(this).text(),r=t(this).data("html"),r&&(a=r),o=t("<a />",{href:"#","data-rating-value":i,"data-rating-text":a,html:e.options.showValues?a:""}),n.append(o))}),e.options.showSelectedRating&&n.append(t("<div />",{text:"","class":"br-current-rating"})),e.options.reverse&&n.addClass("br-reverse"),e.options.readonly&&n.addClass("br-readonly"),n},p=function(){return l("userOptions").reverse?"nextAll":"prevAll"},h=function(t){a(t).prop("selected",!0),e.$elem.change()},m=function(){t("option",e.$elem).prop("selected",function(){return this.defaultSelected}),e.$elem.change()},v=function(t){t=t?t:c(),t==l("emptyRatingText")&&(t=""),e.options.showSelectedRating&&e.$elem.parent().find(".br-current-rating").text(t)},y=function(t){return Math.round(Math.floor(10*t)/10%1*100)},b=function(){e.$widget.find("a").removeClass(function(t,e){return(e.match(/(^|\s)br-\S+/g)||[]).join(" ")})},w=function(){var n,i,a=e.$widget.find('a[data-rating-value="'+f()+'"]'),r=l("userOptions").initialRating,o=t.isNumeric(f())?f():0,s=y(r);if(b(),a.addClass("br-selected br-current")[p()]().addClass("br-selected"),!l("ratingMade")&&t.isNumeric(r)){if(o>=r||!s)return;n=e.$widget.find("a"),i=a.length?a[l("userOptions").reverse?"prev":"next"]():n[l("userOptions").reverse?"last":"first"](),i.addClass("br-fractional"),i.addClass("br-fractional-"+s)}},$=function(t){return l("allowEmpty")&&l("userOptions").deselectable?f()==t.attr("data-rating-value"):!1},x=function(n){n.on("click.barrating",function(n){var i,a,r=t(this),o=l("userOptions");return n.preventDefault(),i=r.attr("data-rating-value"),a=r.attr("data-rating-text"),$(r)&&(i=l("emptyRatingValue"),a=l("emptyRatingText")),s("ratingValue",i),s("ratingText",a),s("ratingMade",!0),h(i),v(a),w(),o.onSelect.call(e,f(),c(),n),!1})},R=function(e){e.on("mouseenter.barrating",function(){var e=t(this);b(),e.addClass("br-active")[p()]().addClass("br-active"),v(e.attr("data-rating-text"))})},V=function(t){e.$widget.on("mouseleave.barrating blur.barrating",function(){v(),w()})},O=function(e){e.on("touchstart.barrating",function(e){e.preventDefault(),e.stopPropagation(),t(this).click()})},C=function(t){t.on("click.barrating",function(t){t.preventDefault()})},S=function(t){x(t),e.options.hoverState&&(R(t),V(t))},T=function(t){t.off(".barrating")},j=function(t){var n=e.$widget.find("a");O&&O(n),t?(T(n),C(n)):S(n)};this.show=function(){l()||(n(),u(),e.$widget=g(),e.$widget.insertAfter(e.$elem),w(),v(),j(e.options.readonly),e.$elem.hide())},this.readonly=function(t){"boolean"==typeof t&&l("readOnly")!=t&&(j(t),s("readOnly",t),e.$widget.toggleClass("br-readonly"))},this.set=function(t){var n=l("userOptions");e.$elem.find('option[value="'+t+'"]').val()&&(s("ratingValue",t),s("ratingText",e.$elem.find('option[value="'+t+'"]').text()),s("ratingMade",!0),h(f()),v(c()),w(),n.silent||n.onSelect.call(this,f(),c()))},this.clear=function(){var t=l("userOptions");s("ratingValue",l("originalRatingValue")),s("ratingText",l("originalRatingText")),s("ratingMade",!1),m(),v(c()),w(),t.onClear.call(this,f(),c())},this.destroy=function(){var t=f(),n=c(),a=l("userOptions");T(e.$widget.find("a")),e.$widget.remove(),d(),i(),e.$elem.show(),a.onDestroy.call(this,t,n)}}return e.prototype.init=function(e,n){return this.$elem=t(n),this.options=t.extend({},t.fn.barrating.defaults,e),this.options},e}();t.fn.barrating=function(n,i){return this.each(function(){var a=new e;if(t(this).is("select")||t.error("Sorry, this plugin only works with select fields."),a.hasOwnProperty(n)){if(a.init(i,this),"show"===n)return a.show(i);if(a.$elem.data("barrating"))return a.$widget=t(this).next(".br-widget"),a[n](i)}else{if("object"==typeof n||!n)return i=n,a.init(i,this),a.show();t.error("Method "+n+" does not exist on jQuery.barrating")}})},t.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,onSelect:function(t,e,n){},onClear:function(t,e){},onDestroy:function(t,e){}},t.fn.barrating.BarRating=e});!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b="waitForImages";a.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"],hasImageAttributes:["srcset"]},a.expr[":"]["has-src"]=function(b){return a(b).is('img[src][src!=""]')},a.expr[":"].uncached=function(b){return a(b).is(":has-src")?!b.complete:!1},a.fn.waitForImages=function(){var c,d,e,f=0,g=0,h=a.Deferred();if(a.isPlainObject(arguments[0])?(e=arguments[0].waitForAll,d=arguments[0].each,c=arguments[0].finished):1===arguments.length&&"boolean"===a.type(arguments[0])?e=arguments[0]:(c=arguments[0],d=arguments[1],e=arguments[2]),c=c||a.noop,d=d||a.noop,e=!!e,!a.isFunction(c)||!a.isFunction(d))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var i=a(this),j=[],k=a.waitForImages.hasImageProperties||[],l=a.waitForImages.hasImageAttributes||[],m=/url\(\s*(['"]?)(.*?)\1\s*\)/g;e?i.find("*").addBack().each(function(){var b=a(this);b.is("img:has-src")&&!b.is("[srcset]")&&j.push({src:b.attr("src"),element:b[0]}),a.each(k,function(a,c){var d,e=b.css(c);if(!e)return!0;for(;d=m.exec(e);)j.push({src:d[2],element:b[0]})}),a.each(l,function(a,c){var d=b.attr(c);return d?void j.push({src:b.attr("src"),srcset:b.attr("srcset"),element:b[0]}):!0})}):i.find("img:has-src").each(function(){j.push({src:this.src,element:this})}),f=j.length,g=0,0===f&&(c.call(i[0]),h.resolveWith(i[0])),a.each(j,function(e,j){var k=new Image,l="load."+b+" error."+b;a(k).one(l,function m(b){var e=[g,f,"load"==b.type];return g++,d.apply(j.element,e),h.notifyWith(j.element,e),a(this).off(l,m),g==f?(c.call(i[0]),h.resolveWith(i[0]),!1):void 0}),j.srcset&&(k.srcset=j.srcset),k.src=j.src})}),h.promise()}});